output$contents <- renderTable({
head(data(), 25)
})
# tabPanel 1
output$postCount <-renderPlot({
senderPosts(file_in=input$file1$datapath)
})
observe({
df = data()
updateSelectInput(session, inputId = 'wlength', label = 'Word length',
choices = c(3:5), selected = 3)
})
# tabPanel 2
output$wordCount <-renderPlot({
wordFreq(file_in=input$file1$datapath, wordlength=input$wlength)
})
observe({
df = data()
updateSelectInput(session, inputId = 'user', label = 'Sender',
choices = c("All", levels(df$sender)), selected = 'NA')
updateSelectInput(session, inputId = 'cwlength', label = 'Word length',
choices = c(3:5), selected = 3)
})
# tabPanel 3
output$wCloud <-renderPlot({
chatCloud(file_in=input$file1$datapath,user=input$user, wordlength=input$cwlength)
})
observe({
df = data()
updateSelectInput(session, inputId = 'Tuser', label = 'Sender',
choices = c("All", levels(df$sender)), selected = 'NA')
})
# tabPanel 4
output$timePlot <-renderPlot({
senderTime(file_in=input$file1$datapath,user=input$Tuser)
})
observe({
df = data()
updateSelectInput(session, inputId = 'Duser', label = 'Sender',
choices = c("All", levels(df$sender)), selected = 'NA')
updateSelectInput(session, inputId = 'Dyear', label = 'Year',
choices = levels(factor(year(df$date))),selected = 'NA')
})
# tabPanel 5
output$datePlot <-renderPlot({
senderDate(file_in=input$file1$datapath,user=input$Duser,filtYear=input$Dyear)
})
})
senderDate(file_in = 'data/DoolsWA.txt', filtYear = 2016, user='NA')
senderTime <- function (file_in='data/testChat.txt', user=NA) {
if(user=='All'){
user=NA
}
data <- parseR(in_file=file_in,user=user)
data$time <- hms(data$time)
data$hour<-lubridate::hour(data$time)
labs<-c("12am", "", "2am", "", "4am", "", "6am", "", "8am", "", "10am", "", "12pm", "", "2pm", "", "4pm", "", "6pm", "", "8pm", "", "10pm", "")
# p<- plot_ly(x = ~data$hour, type = 'histogram', mode = 'lines', fill = 'tozeroy') %>%
#   layout(xaxis = list(title = 'Carat'),
#          yaxis = list(title = 'Density'))
#
p <- ggplot(data)
p <- p + geom_density(aes(hour, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
p <- p + scale_x_continuous("Time", breaks=seq(0,23, by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
# p <- p + facet_wrap(~sender,ncol=2)
p <- p + cleanTheme() +
theme(axis.text.x = element_text(angle = 90, hjust=1),
panel.grid.major.x = element_line(color="grey80", size = 0.5, linetype = "dotted"),
axis.title.x=element_blank(),
legend.position="top")
p
}
senderDate <- function(file_in='data/testChat.txt',user=NA,filtYear=NA){
if(user=='All'){
user=NA
}
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$month<-month(data$date,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
labs=levels(data$month)
# data<-droplevels(data)
p <- ggplot(data)
p <- p + geom_density(aes(month, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
# p <- p + geom_density(aes(monthYear, (..count..),fill=sender), stat='count', alpha=0.6,show.legend=F)
p <- p + scale_y_continuous("Number of posts")
# p <- p + scale_x_discrete("Time", labels=levels(data$month))
# p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- p +cleanTheme() +
theme(axis.text.x = element_text(angle = 90, hjust=1),
panel.grid.major.x = element_line(color="grey80", size = 0.5, linetype = "dotted"),
axis.title.x=element_blank()
)
p
}
shinyServer(function(input, output, session) {
data <- reactive({
req(input$file1)
inFile <- input$file1
df <- parseR(in_file=inFile$datapath) # Call my parser function
return(df)
})
observe({
df = data()
updateSelectInput(session, inputId = 'sender', label = 'Sender',
choices = levels(df$sender), selected = 'NA')
})
# Main page
output$contents <- renderTable({
head(data(), 25)
})
# tabPanel 1
output$postCount <-renderPlot({
senderPosts(file_in=input$file1$datapath)
})
observe({
df = data()
updateSelectInput(session, inputId = 'wlength', label = 'Word length',
choices = c(3:5), selected = 3)
})
# tabPanel 2
output$wordCount <-renderPlot({
wordFreq(file_in=input$file1$datapath, wordlength=input$wlength)
})
observe({
df = data()
updateSelectInput(session, inputId = 'user', label = 'Sender',
choices = c("All", levels(df$sender)), selected = 'NA')
updateSelectInput(session, inputId = 'cwlength', label = 'Word length',
choices = c(3:5), selected = 3)
})
# tabPanel 3
output$wCloud <-renderPlot({
chatCloud(file_in=input$file1$datapath,user=input$user, wordlength=input$cwlength)
})
observe({
df = data()
updateSelectInput(session, inputId = 'Tuser', label = 'Sender',
choices = c("All", levels(df$sender)), selected = 'NA')
})
# tabPanel 4
output$timePlot <-renderPlot({
senderTime(file_in=input$file1$datapath,user=input$Tuser)
})
observe({
df = data()
updateSelectInput(session, inputId = 'Duser', label = 'Sender',
choices = c("All", levels(df$sender)), selected = 'NA')
updateSelectInput(session, inputId = 'Dyear', label = 'Year',
choices = levels(factor(year(df$date))),selected = 'NA')
})
# tabPanel 5
output$datePlot <-renderPlot({
senderDate(file_in=input$file1$datapath,user=input$Duser,filtYear=input$Dyear)
})
})
senderDate(file_in = 'data/DoolsWA.txt', filtYear = 2016, user='NA')
file_in = 'data/DoolsWA.txt'
filtYear = 2016
user='NA'
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$month<-month(data$date,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
labs=levels(data$month)
p <- ggplot(data)
p <- p + geom_density(aes(month, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
p
data$month
str(data)
month(data$month)
data$date <- ymd(data$date)
data$month<-month(data$date)
data$month<-month(data$month,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
labs=levels(data$month)
p <- ggplot(data)
p <- p + geom_density(aes(month, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
month(data$month)p
p
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$month<-month(data$date)
data$month<-month(data$month,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
labs=levels(data$month)
p <- ggplot(data)
p <- p + geom_density(aes(month, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$month<-month(data$date)
data$month<-month(data$month,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
labs=levels(data$month)
# data<-droplevels(data)
p <- ggplot(data)
p <- p + geom_density(aes(month(month), (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- p +cleanTheme() +
theme(axis.text.x = element_text(angle = 90, hjust=1),
panel.grid.major.x = element_line(color="grey80", size = 0.5, linetype = "dotted"),
axis.title.x=element_blank()
)
p
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$month<-month(data$date)
# data$month<-month(data$month,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
labs=levels(data$month)
# data<-droplevels(data)
p <- ggplot(data)
p <- p + geom_density(aes(month(month), (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- p +cleanTheme() +
theme(axis.text.x = element_text(angle = 90, hjust=1),
panel.grid.major.x = element_line(color="grey80", size = 0.5, linetype = "dotted"),
axis.title.x=element_blank()
)
p
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$month<-month(data$date)
# data$month<-month(data$month,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
labs=levels(data$month)
# data<-droplevels(data)
p <- ggplot(data)
p <- p + geom_density(aes(month, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- p +cleanTheme() +
theme(axis.text.x = element_text(angle = 90, hjust=1),
panel.grid.major.x = element_line(color="grey80", size = 0.5, linetype = "dotted"),
axis.title.x=element_blank()
)
p
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$month<-month(data$date)
# data$month<-month(data$month,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
head(data)
str(data)
data$month<-month(data$month)
str(data)
p <- ggplot(data)
p <- p + geom_density(aes(month, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_datetime(date_breaks="months", date_labels="%b")
p
data$date <- ymd(data$date)
data$month<-month(data$date)
data$month<-month(data$month,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
labs=levels(data$month)
p <- ggplot(data)
p <- p + geom_density(aes(month, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_datetime(date_breaks="months", date_labels="%b")
p
p <- ggplot(data)
p <- p + geom_density(aes(as.Data(month), (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_datetime(date_breaks="months", date_labels="%b")
p
p <- ggplot(data)
p <- p + geom_density(aes(as.Date(month), (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_datetime(date_breaks="months", date_labels="%b")
p
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$month<-month(data$date)
data$month<-month(data$month,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
head(data)
p <- ggplot(data)
p <- p + geom_density(aes(data, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_datetime(date_breaks="months", date_labels="%b")
p
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_datetime(date_breaks="months", date_labels="%b")
p
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$month<-month(data$month,label = TRUE,abbr = TRUE)
data$year<-year(data$date)
data <- parseR(in_file=file_in,user=user)
data <- filter(data, year == filtYear)
data <- parseR(in_file=file_in,user=user)
data <- filter(data, year == filtYear)
head(data)
str(data)
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
labs=levels(data$month)
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_datetime(date_breaks="months", date_labels="%b")
p
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- p +cleanTheme() +
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- p +cleanTheme() +
theme(axis.text.x = element_text(angle = 90, hjust=1),
panel.grid.major.x = element_line(color="grey80", size = 0.5, linetype = "dotted"),
axis.title.x=element_blank()
)
p
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- p +cleanTheme() +
theme(axis.text.x = element_text(angle = 90, hjust=1),
panel.grid.major.x = element_line(color="grey80", size = 0.5, linetype = "dotted"),
axis.title.x=element_blank()
)
p
p <- ggplot(data)
# p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
p <- p + geom_bar(aes(date, (..count..), fill = sender),binwidth = 30, stat='count',colour='black')
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- p +cleanTheme() +
theme(axis.text.x = element_text(angle = 90, hjust=1),
panel.grid.major.x = element_line(color="grey80", size = 0.5, linetype = "dotted"),
axis.title.x=element_blank()
)
p
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + geom_bar(aes(date, (..count..), fill = sender),binwidth = 30, stat='count',colour='black')
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- p +cleanTheme() +
theme(axis.text.x = element_text(angle = 90, hjust=1),
panel.grid.major.x = element_line(color="grey80", size = 0.5, linetype = "dotted"),
axis.title.x=element_blank()
)
p
data$date<-as.POSIXct(data$date,
format = "%d/%m/%Y",
tz = "GMT")
head(data)
str(data)
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p
p <- p + scale_x_date(aes(date),date_breaks="months", date_labels="%b")
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + geom_bar(aes(date, (..count..), fill = sender),binwidth = 30, stat='count',colour='black')
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(aes(date),date_breaks="months", date_labels="%b")
p
?date_labels()
senderDate <- function(file_in='data/testChat.txt',user=NA,filtYear=NA){
if(user=='All'){
user=NA
}
data <- parseR(in_file=file_in,user=user)
data <- filter(data, year == filtYear)
data$date <- ymd(data$date)
data$month<-month(data$month,label = TRUE,abbr = TRUE)
# data$year<-year(data$date)
labs=levels(data$month)
# data<-droplevels(data)
data$date<-as.POSIXct(data$date,
format = "%d/%m/%Y",
tz = "GMT")
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p <- p +cleanTheme() +
theme(axis.text.x = element_text(angle = 90, hjust=1),
panel.grid.major.x = element_line(color="grey80", size = 0.5, linetype = "dotted"),
axis.title.x=element_blank()
)
p
}
senderDate(file_in = 'data/DoolsWA.txt', filtYear = 2016)
senderDate(file_in = 'data/DoolsWA.txt', filtYear = 2016, user=NA)
senderDate(file_in = 'data/DoolsWA.txt', filtYear = 2016, user='NA')
if(user=='All'){
user=NA
}
data <- parseR(in_file=file_in,user=user)
data <- filter(data, year == filtYear)
data <- filter(data, year == 2016)
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$year<-year(data$date)
data <- filter(data, year == filtYear)
head(data)
data$month<-month(data$month,label = TRUE,abbr = TRUE)
data$month<-month(data$date,label = TRUE,abbr = TRUE)
head(data)
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p
filtYear=NA
if(user=='All'){
user=NA
}
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
data$year<-year(data$date)
data$month<-month(data$date,label = TRUE,abbr = TRUE)
labs=levels(data$month)
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p
data <- filter(data, year == filtYear)
data$month<-month(data$date,label = TRUE,abbr = TRUE)
labs=levels(data$month)
p <- ggplot(data)
p <- p + geom_density(aes(date, (..count..), fill = sender), stat='count', alpha=0.9,show.legend=F)
# p <- p + scale_x_discrete("Time", breaks=seq(1,length(labs), by=1), labels=labs)
p <- p + scale_y_continuous("Number of posts")
p <- p + scale_x_date(date_breaks="months", date_labels="%b")
p
runApp('shiny')
max(data$sender)
t<-table(data$sender)
t
max(t)
data <- parseR(in_file=file_in,user=user)
data$time <- hms(data$time)
data$hour<-lubridate::hour(data$time)
labs<-c("12am", "", "2am", "", "4am", "", "6am", "", "8am", "", "10am", "", "12pm", "", "2pm", "", "4pm", "", "6pm", "", "8pm", "", "10pm", "")
t<-table(data$sender)
max(t)
runApp('shiny')
data <- parseR(in_file=file_in,user=user)
data$date <- ymd(data$date)
str(data$date)
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
